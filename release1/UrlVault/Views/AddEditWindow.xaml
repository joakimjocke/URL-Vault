<Window x:Class="UrlVault.Views.AddEditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:UrlVault.Converters"
        Title="Add / Edit URL" Height="540" Width="520"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#F5F5F5">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <converters:InverseBoolToVisibilityConverter x:Key="InverseBoolToVis"/>
        <converters:StringToVisibilityConverter x:Key="StringToVis"/>

        <Style x:Key="FormLabel" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
            <Setter Property="Foreground" Value="#3F51B5"/>
        </Style>
        <Style x:Key="FormTextBox" TargetType="TextBox">
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="BorderBrush" Value="#C5CAE9"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="Background" Value="#3F51B5"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#5C6BC0"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#9E9E9E"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- URL -->
            <TextBlock Grid.Row="0" Text="URL *" Style="{StaticResource FormLabel}"/>
            <Grid Grid.Row="1" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox Text="{Binding Url, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource FormTextBox}"/>
                <Button Grid.Column="1" Command="{Binding FetchTitleCommand}"
                        Margin="6,0,0,0" Style="{StaticResource ActionButton}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Fetch Title"
                                   Visibility="{Binding IsFetchingTitle, Converter={StaticResource InverseBoolToVis}}"/>
                        <TextBlock Text="Fetching..."
                                   Visibility="{Binding IsFetchingTitle, Converter={StaticResource BoolToVis}}"/>
                    </StackPanel>
                </Button>
            </Grid>

            <!-- Title -->
            <TextBlock Grid.Row="2" Text="Title" Style="{StaticResource FormLabel}"/>
            <TextBox Grid.Row="3" Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource FormTextBox}" Margin="0,0,0,12"/>

            <!-- Category -->
            <TextBlock Grid.Row="4" Text="Category" Style="{StaticResource FormLabel}"/>
            <ComboBox Grid.Row="5" ItemsSource="{Binding AvailableCategories}"
                      SelectedItem="{Binding Category}"
                      Padding="8,6" FontSize="13" Margin="0,0,0,12"/>

            <!-- Tags -->
            <TextBlock Grid.Row="6" Text="Tags" Style="{StaticResource FormLabel}"/>
            <Border Grid.Row="7" BorderBrush="#C5CAE9" BorderThickness="1" CornerRadius="2"
                    Margin="0,0,0,12" MaxHeight="100">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding TagSelections}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal" Margin="4"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Content="{Binding Tag}" IsChecked="{Binding IsSelected}"
                                          Margin="4,2"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Border>

            <!-- Comment -->
            <TextBlock Grid.Row="8" Text="Comment" Style="{StaticResource FormLabel}"/>
            <TextBox Grid.Row="9" Text="{Binding Comment, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource FormTextBox}"
                     AcceptsReturn="True" TextWrapping="Wrap"
                     Height="60" VerticalScrollBarVisibility="Auto"
                     Margin="0,0,0,8"/>

            <!-- Duplicate Warning -->
            <TextBlock Grid.Row="10" Text="{Binding DuplicateWarning}"
                       Foreground="Red" FontSize="12"
                       Visibility="{Binding DuplicateWarning, Converter={StaticResource StringToVis}}"
                       Margin="0,0,0,8"/>

            <!-- Buttons -->
            <StackPanel Grid.Row="11" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Cancel" Command="{Binding CancelCommand}"
                        Style="{StaticResource ActionButton}" Background="#757575"/>
                <Button Content="Save" Command="{Binding SaveCommand}"
                        Style="{StaticResource ActionButton}" IsDefault="True"/>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</Window>
